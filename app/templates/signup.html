<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signup</title>
    <link rel="stylesheet" href="{{ url_for('static', path='/tailwind.css') }}">
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
    <div class="w-full max-w-md bg-white p-8 rounded-lg shadow-md">
        <h2 class="text-2xl font-bold text-center mb-6">Create Account</h2>

        {# Display Error Message #}
        {% if error %}
            <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
                <strong class="font-bold">Error:</strong>
                <span class="block sm:inline">{{ error }}</span>
            </div>
        {% endif %}

        <form id="signupForm" action="/auth/signup" method="post">

            {# Step 1: Basic Details #}
            <div id="step1" class="form-step">
                <h3 class="text-xl font-semibold mb-4">Basic Details</h3>

                <div class="mb-4">
                    <label for="first" class="block text-gray-700 text-sm font-bold mb-2">First Name:</label>
                    <input type="text" id="first" name="first" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                <div class="mb-4">
                    <label for="middle" class="block text-gray-700 text-sm font-bold mb-2">Middle Name (Optional):</label>
                    <input type="text" id="middle" name="middle" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                <div class="mb-4">
                    <label for="last" class="block text-gray-700 text-sm font-bold mb-2">Last Name:</label>
                    <input type="text" id="last" name="last" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                <div class="mb-4">
                    <label for="email" class="block text-gray-700 text-sm font-bold mb-2">Email:</label>
                    <input type="email" id="email" name="email" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                 <div class="mb-4">
                    <label for="phone_number" class="block text-gray-700 text-sm font-bold mb-2">Phone Number:</label>
                    <input type="tel" id="phone_number" name="phone_number" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                <div class="mb-4">
                    <label for="password" class="block text-gray-700 text-sm font-bold mb-2">Password:</label>
                    <input type="password" id="password" name="password" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                <div class="mb-4">
                    <label for="age" class="block text-gray-700 text-sm font-bold mb-2">Age:</label>
                    <input type="number" id="age" name="age" required min="0" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                <div class="mb-6">
                    <label for="gender" class="block text-gray-700 text-sm font-bold mb-2">Gender:</label>
                    <select id="gender" name="gender" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                        <option value="">Select Gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                        <option value="Other">Other</option>
                    </select>
                </div>

                <h4 class="text-lg font-semibold mb-3">Address</h4>
                 <div class="mb-4">
                    <label for="street" class="block text-gray-700 text-sm font-bold mb-2">Street:</label>
                    <input type="text" id="street" name="street" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                 <div class="mb-4">
                    <label for="city" class="block text-gray-700 text-sm font-bold mb-2">City:</label>
                    <input type="text" id="city" name="city" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                 <div class="mb-4">
                    <label for="state" class="block text-gray-700 text-sm font-bold mb-2">State:</label>
                    <input type="text" id="state" name="state" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                 <div class="mb-4">
                    <label for="zip" class="block text-gray-700 text-sm font-bold mb-2">Zip Code:</label>
                    <input type="text" id="zip" name="zip" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                 <div class="mb-6">
                    <label for="country" class="block text-gray-700 text-sm font-bold mb-2">Country:</label>
                    <input type="text" id="country" name="country" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>

                <h4 class="text-lg font-semibold mb-3">Emergency Contact</h4>
                 <div class="mb-4">
                    <label for="emergency_name" class="block text-gray-700 text-sm font-bold mb-2">Name:</label>
                    <input type="text" id="emergency_name" name="emergency_name" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                 <div class="mb-4">
                    <label for="emergency_phone" class="block text-gray-700 text-sm font-bold mb-2">Phone:</label>
                    <input type="tel" id="emergency_phone" name="emergency_phone" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>
                 <div class="mb-6">
                    <label for="emergency_relationship" class="block text-gray-700 text-sm font-bold mb-2">Relationship:</label>
                    <input type="text" id="emergency_relationship" name="emergency_relationship" required class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                </div>

                <button type="button" onclick="nextStep()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full">Next</button>
            </div>

            {# Step 2: Medical Details #}
            <div id="step2" class="form-step hidden">
                 <h3 class="text-xl font-semibold mb-4">Medical Details (Optional)</h3>

                <div class="mb-4">
                    <label for="allergies_text" class="block text-gray-700 text-sm font-bold mb-2">Allergies (Comma separated):</label>
                    <textarea id="allergies_text" name="allergies_text" rows="2" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                </div>
                 <div class="mb-4">
                    <label for="family_medical_history" class="block text-gray-700 text-sm font-bold mb-2">Family Medical History:</label>
                    <textarea id="family_medical_history" name="family_medical_history" rows="3" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                </div>

                {# Text areas for other medical lists - explain to the user to enter as text #}
                <p class="text-sm text-gray-600 mb-4">Please list the following medical information below. You can provide details as text, e.g., "Medication Name: 500mg, twice daily".</p>

                 <div class="mb-4">
                    <label for="current_medications_text" class="block text-gray-700 text-sm font-bold mb-2">Current Medications:</label>
                    <textarea id="current_medications_text" name="current_medications_text" rows="3" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                </div>
                 <div class="mb-4">
                    <label for="diagnoses_text" class="block text-gray-700 text-sm font-bold mb-2">Diagnoses:</label>
                    <textarea id="diagnoses_text" name="diagnoses_text" rows="3" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                </div>
                 <div class="mb-4">
                    <label for="prescriptions_text" class="block text-gray-700 text-sm font-bold mb-2">Prescriptions:</label>
                    <textarea id="prescriptions_text" name="prescriptions_text" rows="3" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                </div>
                 <div class="mb-4">
                    <label for="consultation_history_text" class="block text-gray-700 text-sm font-bold mb-2">Consultation History:</label>
                    <textarea id="consultation_history_text" name="consultation_history_text" rows="3" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                </div>
                 <div class="mb-4">
                    <label for="reports_text" class="block text-gray-700 text-sm font-bold mb-2">Reports:</label>
                    <textarea id="reports_text" name="reports_text" rows="3" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                </div>
                <div class="mb-6">
                    <label for="immunizations_text" class="block text-gray-700 text-sm font-bold mb-2">Immunizations:</label>
                    <textarea id="immunizations_text" name="immunizations_text" rows="3" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"></textarea>
                </div>


                <div class="flex justify-between">
                    <button type="button" onclick="prevStep()" class="bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">Previous</button>
                    <button type="submit" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">Sign Up</button>
                </div>
            </div>
        </form>

        <p class="text-center text-gray-500 text-sm mt-6">
            Already have an account? <a href="/auth/login" class="text-blue-500 hover:text-blue-700">Login here</a>.
        </p>
    </div>

    <script>
        const step1 = document.getElementById('step1');
        const step2 = document.getElementById('step2');

        function nextStep() {
            // Simple validation for Step 1 fields before proceeding (can be enhanced)
            const step1Inputs = step1.querySelectorAll('input[required], select[required]');
            let allFilled = true;
            step1Inputs.forEach(input => {
                if (!input.value) {
                    allFilled = false;
                    input.classList.add('border-red-500'); // Highlight missing fields (requires corresponding CSS)
                } else {
                     input.classList.remove('border-red-500');
                }
            });

            if (allFilled) {
                step1.classList.add('hidden');
                step2.classList.remove('hidden');
            } else {
                 alert('Please fill all required fields in Basic Details.');
            }
        }

        function prevStep() {
            step2.classList.add('hidden');
            step1.classList.remove('hidden');
        }
    </script>
</body>
</html>